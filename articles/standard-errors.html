<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Standard Errors • plavaan</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Standard Errors">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">plavaan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/approximate-invariance.html">Approximate Invariance with Penalized Estimation</a></li>
    <li><a class="dropdown-item" href="../articles/penalized-cat.html">Penalized Estimation with Ordinal Data and Multiple Groups</a></li>
    <li><a class="dropdown-item" href="../articles/penalized-fa.html">Penalized Estimation of Cross-Loadings and Unique Covariances</a></li>
    <li><a class="dropdown-item" href="../articles/standard-errors.html">Standard Errors</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Standard Errors</h1>
            
      

      <div class="d-none name"><code>standard-errors.Rmd</code></div>
    </div>

    
    
<p>This vignette demonstrates the calculation of standard errors for
penalized estimates, using the sandwich estimator approach as in the
“MLR” estimator of <code>lavaan</code>. The standard errors are obtained
as the square roots of the diagonal elements of the sandwich variance
estimator:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi mathvariant="normal">B</mi><mtext mathvariant="normal">bread</mtext><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><mspace width="0.278em"></mspace><msub><mi mathvariant="normal">B</mi><mtext mathvariant="normal">meat</mtext></msub><mspace width="0.278em"></mspace><msubsup><mi mathvariant="normal">B</mi><mtext mathvariant="normal">bread</mtext><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><mo>,</mo></mrow><annotation encoding="application/x-tex">
\mathrm{B}_\text{bread}^{-1} \; \mathrm{B}_\text{meat} \; \mathrm{B}_\text{bread}^{-1},
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi mathvariant="normal">B</mi><mtext mathvariant="normal">bread</mtext></msub><annotation encoding="application/x-tex">\mathrm{B}_\text{bread}</annotation></semantics></math>
is the observed information matrix (i.e., the Hessian of the penalized
objective function) and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi mathvariant="normal">B</mi><mtext mathvariant="normal">meat</mtext></msub><annotation encoding="application/x-tex">\mathrm{B}_\text{meat}</annotation></semantics></math>
is the first-order information matrix (obtained using
<code>lavInspect(..., information.first.order)</code>).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lavaan.ugent.be" class="external-link">lavaan</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; This is lavaan 0.6-20</span></span>
<span><span class="co">#&gt; lavaan is FREE software! Please report any bugs.</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://marklhc.github.io/plavaan/">plavaan</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">PoliticalDemocracy</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="penalize-cross-loadings">Penalize cross-loadings<a class="anchor" aria-label="anchor" href="#penalize-cross-loadings"></a>
</h2>
<div class="section level3">
<h3 id="two-factor-cfa-model">Two-factor CFA model<a class="anchor" aria-label="anchor" href="#two-factor-cfa-model"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod0</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">  ind60 =~ x1 + x2 + x3</span></span>
<span><span class="st">  dem60 =~ y1 + y2 + y3 + y4</span></span>
<span><span class="st">  ind60 ~~ dem60</span></span>
<span><span class="st">"</span></span>
<span><span class="va">fit0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/cfa.html" class="external-link">cfa</a></span><span class="op">(</span><span class="va">mod0</span>, data <span class="op">=</span> <span class="va">PoliticalDemocracy</span>, std.lv <span class="op">=</span> <span class="cn">TRUE</span>, estimator <span class="op">=</span> <span class="st">"MLR"</span><span class="op">)</span></span></code></pre></div>
<p>Penalized</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">  ind60 =~ x1 + x2 + x3 + y1 + y2 + y3 + y4</span></span>
<span><span class="st">  dem60 =~ x1 + x2 + x3 + y1 + y2 + y3 + y4</span></span>
<span><span class="st">  ind60 ~~ ind60</span></span>
<span><span class="st">"</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/cfa.html" class="external-link">cfa</a></span><span class="op">(</span><span class="va">mod</span>, data <span class="op">=</span> <span class="va">PoliticalDemocracy</span>, std.lv <span class="op">=</span> <span class="cn">TRUE</span>, do.fit <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pefa_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/penalized_est.html">penalized_est</a></span><span class="op">(</span></span>
<span>    <span class="va">fit</span>,</span>
<span>    w <span class="op">=</span> <span class="fl">.03</span>,</span>
<span>    pen_par_id <span class="op">=</span> <span class="fl">4</span><span class="op">:</span><span class="fl">10</span>,</span>
<span>    se <span class="op">=</span> <span class="st">"robust.huber.white"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">pefa_fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; lavaan 0.6-20 ended normally after 126 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Estimator                                         ML</span></span>
<span><span class="co">#&gt;   Optimization method                           NLMINB</span></span>
<span><span class="co">#&gt;   Number of model parameters                        22</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Number of observations                            75</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter Estimates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Standard errors                             Sandwich</span></span>
<span><span class="co">#&gt;   Information bread                           Observed</span></span>
<span><span class="co">#&gt;   Observed information based on                Hessian</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Latent Variables:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)</span></span>
<span><span class="co">#&gt;   ind60 =~                                            </span></span>
<span><span class="co">#&gt;     x1                0.658    0.056   11.713    0.000</span></span>
<span><span class="co">#&gt;     x2                1.456    0.106   13.692    0.000</span></span>
<span><span class="co">#&gt;     x3                1.222    0.103   11.908    0.000</span></span>
<span><span class="co">#&gt;     y1               -0.007    0.008   -0.867    0.386</span></span>
<span><span class="co">#&gt;     y2               -0.608    0.476   -1.275    0.202</span></span>
<span><span class="co">#&gt;     y3               -0.001    0.006   -0.220    0.826</span></span>
<span><span class="co">#&gt;     y4                0.006    0.008    0.819    0.413</span></span>
<span><span class="co">#&gt;   dem60 =~                                            </span></span>
<span><span class="co">#&gt;     x1                0.025    0.027    0.943    0.346</span></span>
<span><span class="co">#&gt;     x2               -0.002    0.014   -0.122    0.903</span></span>
<span><span class="co">#&gt;     x3               -0.010    0.015   -0.650    0.515</span></span>
<span><span class="co">#&gt;     y1                2.071    0.217    9.526    0.000</span></span>
<span><span class="co">#&gt;     y2                3.290    0.380    8.652    0.000</span></span>
<span><span class="co">#&gt;     y3                2.256    0.338    6.669    0.000</span></span>
<span><span class="co">#&gt;     y4                2.999    0.234   12.833    0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariances:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)</span></span>
<span><span class="co">#&gt;   ind60 ~~                                            </span></span>
<span><span class="co">#&gt;     dem60             0.481    0.107    4.475    0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)</span></span>
<span><span class="co">#&gt;     ind60             1.000                           </span></span>
<span><span class="co">#&gt;    .x1                0.079    0.018    4.352    0.000</span></span>
<span><span class="co">#&gt;    .x2                0.127    0.072    1.762    0.078</span></span>
<span><span class="co">#&gt;    .x3                0.464    0.082    5.651    0.000</span></span>
<span><span class="co">#&gt;    .y1                2.493    0.550    4.529    0.000</span></span>
<span><span class="co">#&gt;    .y2                6.048    1.370    4.415    0.000</span></span>
<span><span class="co">#&gt;    .y3                5.512    1.209    4.561    0.000</span></span>
<span><span class="co">#&gt;    .y4                2.017    0.635    3.177    0.001</span></span>
<span><span class="co">#&gt;     dem60             1.000</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Quick simulation to check SEs</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">R</span> <span class="op">&lt;-</span> <span class="fl">250</span></span>
<span><span class="va">est_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, nrow <span class="op">=</span> <span class="va">R</span>, ncol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">pefa_fit</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">se_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, nrow <span class="op">=</span> <span class="va">R</span>, ncol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">pefa_fit</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use the simple structure model as population</span></span>
<span><span class="va">pop_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/parTable.html" class="external-link">parTable</a></span><span class="op">(</span><span class="va">pefa_fit</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">R</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># Simulate data</span></span>
<span>    <span class="va">dat_sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/simulateData.html" class="external-link">simulateData</a></span><span class="op">(</span><span class="va">pop_model</span>, sample.nobs <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co"># Fit penalized model</span></span>
<span>    <span class="va">fit_sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/cfa.html" class="external-link">cfa</a></span><span class="op">(</span><span class="va">mod</span>, data <span class="op">=</span> <span class="va">dat_sim</span>, std.lv <span class="op">=</span> <span class="cn">TRUE</span>, do.fit <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>    <span class="va">pefa_sim</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="../reference/penalized_est.html">penalized_est</a></span><span class="op">(</span></span>
<span>            <span class="va">fit_sim</span>,</span>
<span>            w <span class="op">=</span> <span class="fl">.03</span>,</span>
<span>            pen_par_id <span class="op">=</span> <span class="fl">4</span><span class="op">:</span><span class="fl">10</span>,</span>
<span>            se <span class="op">=</span> <span class="st">"robust.huber.white"</span></span>
<span>        <span class="op">)</span>,</span>
<span>        silent <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">inherits</a></span><span class="op">(</span><span class="va">pefa_sim</span>, <span class="st">"try-error"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">est_res</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">pefa_sim</span><span class="op">)</span></span>
<span>        <span class="va">se_res</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">pefa_sim</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Compare empirical SD vs mean SE for a few parameters</span></span>
<span><span class="co"># (e.g., first few loadings)</span></span>
<span><span class="va">res_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">pefa_fit</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    emp_sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">est_res</span>, <span class="fl">2</span>, <span class="va">sd</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    mean_se <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">se_res</span>, <span class="fl">2</span>, <span class="va">mean</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">res_summary</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt;           param emp_sd mean_se</span></span>
<span><span class="co">#&gt; 1     ind60=~x1 0.0380  0.0393</span></span>
<span><span class="co">#&gt; 2     ind60=~x2 0.0750  0.0772</span></span>
<span><span class="co">#&gt; 3     ind60=~x3 0.0787  0.0777</span></span>
<span><span class="co">#&gt; 4     ind60=~y1 0.0291  0.0060</span></span>
<span><span class="co">#&gt; 5     ind60=~y2 0.0704  0.0087</span></span>
<span><span class="co">#&gt; 6     ind60=~y3 0.0532  0.0069</span></span>
<span><span class="co">#&gt; 7     ind60=~y4 0.2631  0.1266</span></span>
<span><span class="co">#&gt; 8     dem60=~x1 0.0154  0.0152</span></span>
<span><span class="co">#&gt; 9     dem60=~x2 0.0093  0.0091</span></span>
<span><span class="co">#&gt; 10    dem60=~x3 0.0109  0.0106</span></span>
<span><span class="co">#&gt; 11    dem60=~y1 0.1586  0.1575</span></span>
<span><span class="co">#&gt; 12    dem60=~y2 0.2616  0.2445</span></span>
<span><span class="co">#&gt; 13    dem60=~y3 0.2160  0.2088</span></span>
<span><span class="co">#&gt; 14    dem60=~y4 0.2340  0.2057</span></span>
<span><span class="co">#&gt; 15       x1~~x1 0.0106  0.0116</span></span>
<span><span class="co">#&gt; 16       x2~~x2 0.0388  0.0436</span></span>
<span><span class="co">#&gt; 17       x3~~x3 0.0540  0.0536</span></span>
<span><span class="co">#&gt; 18       y1~~y1 0.3085  0.3133</span></span>
<span><span class="co">#&gt; 19       y2~~y2 0.8018  0.7797</span></span>
<span><span class="co">#&gt; 20       y3~~y3 0.5965  0.6039</span></span>
<span><span class="co">#&gt; 21       y4~~y4 0.4302  0.4333</span></span>
<span><span class="co">#&gt; 22 ind60~~dem60 0.0763  0.0686</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># meat &lt;- lavInspect(pefa_fit, "information.first.order")</span></span>
<span><span class="co"># bread &lt;- attr(pefa_fit, "hessian")</span></span>
<span><span class="co"># vc_pefa &lt;- solve(bread) %*% meat %*% solve(bread) / 75</span></span>
<span><span class="co"># pefa_fit@vcov$vcov &lt;- vc_pefa</span></span>
<span><span class="co"># se_pefa &lt;- sqrt(diag(vc_pefa))</span></span>
<span><span class="co"># pefa_fit@ParTable$se &lt;- 0 * pefa_fit@ParTable$est</span></span>
<span><span class="co"># pefa_fit@ParTable$se[which(pefa_fit@ParTable$free &gt; 0)] &lt;- se_pefa</span></span>
<span><span class="co"># cbind(coef(pefa_fit), sqrt(diag(vc_pefa)))</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="penalize-non-invariance">Penalize non-invariance<a class="anchor" aria-label="anchor" href="#penalize-non-invariance"></a>
</h2>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lconfig_mod_un</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">    # Time 1</span></span>
<span><span class="st">    dem60 =~ .l1_1 * y1 + .l2_1 * y2 + .l3_1 * y3 + .l4_1 * y4</span></span>
<span><span class="st">    y1 ~ .i1_1 * 1</span></span>
<span><span class="st">    y2 ~ .i2_1 * 1</span></span>
<span><span class="st">    y3 ~ .i3_1 * 1</span></span>
<span><span class="st">    y4 ~ .i4_1 * 1</span></span>
<span><span class="st">    y1 ~~ .u1_1 * y1</span></span>
<span><span class="st">    y2 ~~ .u2_1 * y2</span></span>
<span><span class="st">    y3 ~~ .u3_1 * y3</span></span>
<span><span class="st">    y4 ~~ .u4_1 * y4</span></span>
<span><span class="st">    </span></span>
<span><span class="st">    # Time 2</span></span>
<span><span class="st">    dem65 =~ .l1_2 * y5 + .l2_2 * y6 + .l3_2 * y7 + .l4_2 * y8</span></span>
<span><span class="st">    y5 ~ .i1_2 * 1</span></span>
<span><span class="st">    y6 ~ .i2_2 * 1</span></span>
<span><span class="st">    y7 ~ .i3_2 * 1</span></span>
<span><span class="st">    y8 ~ .i4_2 * 1</span></span>
<span><span class="st">    y5 ~~ .u1_2 * y5</span></span>
<span><span class="st">    y6 ~~ .u2_2 * y6</span></span>
<span><span class="st">    y7 ~~ .u3_2 * y7</span></span>
<span><span class="st">    y8 ~~ .u4_2 * y8</span></span>
<span><span class="st">    </span></span>
<span><span class="st">    # Latent variances</span></span>
<span><span class="st">    dem60 ~~ 1 * dem60</span></span>
<span><span class="st">    dem65 ~~ NA * dem65</span></span>
<span><span class="st">    </span></span>
<span><span class="st">    # Latent means</span></span>
<span><span class="st">    dem60 ~ 0 * 1</span></span>
<span><span class="st">    dem65 ~ NA * 1</span></span>
<span><span class="st">    </span></span>
<span><span class="st">    # Lag Covariances</span></span>
<span><span class="st">    y1 ~~ y5</span></span>
<span><span class="st">    y2 ~~ y6</span></span>
<span><span class="st">    y3 ~~ y7</span></span>
<span><span class="st">    y4 ~~ y8</span></span>
<span><span class="st">"</span></span>
<span><span class="co"># Specify the under-identified model</span></span>
<span><span class="va">lconfig_fit_un</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/cfa.html" class="external-link">cfa</a></span><span class="op">(</span></span>
<span>    <span class="va">lconfig_mod_un</span>,</span>
<span>    data <span class="op">=</span> <span class="va">PoliticalDemocracy</span>,</span>
<span>    do.fit <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    std.lv <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    missing <span class="op">=</span> <span class="st">"fiml"</span>,</span>
<span>    estimator <span class="op">=</span> <span class="st">"mlr"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">ld_id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">13</span><span class="op">:</span><span class="fl">16</span><span class="op">)</span></span>
<span><span class="va">int_id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fl">5</span><span class="op">:</span><span class="fl">8</span>, <span class="fl">17</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span></span>
<span><span class="va">pen_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/penalized_est.html">penalized_est</a></span><span class="op">(</span></span>
<span>    <span class="va">lconfig_fit_un</span>,</span>
<span>    w <span class="op">=</span> <span class="fl">0.03</span>,</span>
<span>    pen_fn <span class="op">=</span> <span class="st">"l0a"</span>,</span>
<span>    pen_diff_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>loadings <span class="op">=</span> <span class="va">ld_id</span>, intercepts <span class="op">=</span> <span class="va">int_id</span><span class="op">)</span>,</span>
<span>    se <span class="op">=</span> <span class="st">"robust.huber.white"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/parameterEstimates.html" class="external-link">parameterEstimates</a></span><span class="op">(</span><span class="va">pen_fit</span><span class="op">)</span></span>
<span><span class="co">#&gt;      lhs op   rhs label    est    se      z pvalue ci.lower ci.upper</span></span>
<span><span class="co">#&gt; 1  dem60 =~    y1 .l1_1  2.105 0.207 10.182  0.000    1.700    2.510</span></span>
<span><span class="co">#&gt; 2  dem60 =~    y2 .l2_1  2.852 0.290  9.828  0.000    2.283    3.420</span></span>
<span><span class="co">#&gt; 3  dem60 =~    y3 .l3_1  2.531 0.241 10.512  0.000    2.059    3.003</span></span>
<span><span class="co">#&gt; 4  dem60 =~    y4 .l4_1  2.905 0.226 12.872  0.000    2.462    3.347</span></span>
<span><span class="co">#&gt; 5     y1 ~1       .i1_1  5.456 0.288 18.918  0.000    4.890    6.021</span></span>
<span><span class="co">#&gt; 6     y2 ~1       .i2_1  4.251 0.453  9.389  0.000    3.364    5.139</span></span>
<span><span class="co">#&gt; 7     y3 ~1       .i3_1  6.572 0.355 18.513  0.000    5.876    7.268</span></span>
<span><span class="co">#&gt; 8     y4 ~1       .i4_1  4.460 0.366 12.173  0.000    3.742    5.178</span></span>
<span><span class="co">#&gt; 9     y1 ~~    y1 .u1_1  2.129 0.487  4.370  0.000    1.174    3.084</span></span>
<span><span class="co">#&gt; 10    y2 ~~    y2 .u2_1  6.632 1.319  5.030  0.000    4.048    9.217</span></span>
<span><span class="co">#&gt; 11    y3 ~~    y3 .u3_1  5.388 1.095  4.921  0.000    3.242    7.534</span></span>
<span><span class="co">#&gt; 12    y4 ~~    y4 .u4_1  2.594 0.643  4.033  0.000    1.333    3.854</span></span>
<span><span class="co">#&gt; 13 dem65 =~    y5 .l1_2  2.083 0.210  9.929  0.000    1.672    2.494</span></span>
<span><span class="co">#&gt; 14 dem65 =~    y6 .l2_2  2.819 0.290  9.710  0.000    2.250    3.388</span></span>
<span><span class="co">#&gt; 15 dem65 =~    y7 .l3_2  2.602 0.252 10.322  0.000    2.108    3.096</span></span>
<span><span class="co">#&gt; 16 dem65 =~    y8 .l4_2  2.898 0.225 12.905  0.000    2.458    3.339</span></span>
<span><span class="co">#&gt; 17    y5 ~1       .i1_2  5.454 0.288 18.945  0.000    4.890    6.019</span></span>
<span><span class="co">#&gt; 18    y6 ~1       .i2_2  3.393 0.428  7.937  0.000    2.555    4.231</span></span>
<span><span class="co">#&gt; 19    y7 ~1       .i3_2  6.572 0.355 18.490  0.000    5.876    7.269</span></span>
<span><span class="co">#&gt; 20    y8 ~1       .i4_2  4.460 0.366 12.182  0.000    3.743    5.178</span></span>
<span><span class="co">#&gt; 21    y5 ~~    y5 .u1_2  2.816 0.591  4.769  0.000    1.659    3.974</span></span>
<span><span class="co">#&gt; 22    y6 ~~    y6 .u2_2  4.003 0.803  4.986  0.000    2.429    5.576</span></span>
<span><span class="co">#&gt; 23    y7 ~~    y7 .u3_2  3.590 0.637  5.640  0.000    2.342    4.838</span></span>
<span><span class="co">#&gt; 24    y8 ~~    y8 .u4_2  2.457 0.721  3.409  0.001    1.044    3.870</span></span>
<span><span class="co">#&gt; 25 dem60 ~~ dem60        1.000 0.000     NA     NA    1.000    1.000</span></span>
<span><span class="co">#&gt; 26 dem65 ~~ dem65        0.951 0.097  9.812  0.000    0.761    1.141</span></span>
<span><span class="co">#&gt; 27 dem60 ~1              0.000 0.000     NA     NA    0.000    0.000</span></span>
<span><span class="co">#&gt; 28 dem65 ~1             -0.147 0.070 -2.091  0.037   -0.284   -0.009</span></span>
<span><span class="co">#&gt; 29    y1 ~~    y5        0.842 0.433  1.943  0.052   -0.007    1.692</span></span>
<span><span class="co">#&gt; 30    y2 ~~    y6        1.820 0.880  2.068  0.039    0.095    3.545</span></span>
<span><span class="co">#&gt; 31    y3 ~~    y7        1.222 0.644  1.898  0.058   -0.040    2.483</span></span>
<span><span class="co">#&gt; 32    y4 ~~    y8        0.284 0.467  0.608  0.543   -0.632    1.201</span></span>
<span><span class="co">#&gt; 33 dem60 ~~ dem65        0.918 0.057 16.132  0.000    0.806    1.029</span></span></code></pre></div>
<p>Compared to scalar invariance model</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lscalar_mod</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">    # Time 1</span></span>
<span><span class="st">    dem60 =~ .l1 * y1 + .l2 * y2 + .l3 * y3 + .l4 * y4</span></span>
<span><span class="st">    y1 ~ .i1 * 1</span></span>
<span><span class="st">    y2 ~ .i2 * 1</span></span>
<span><span class="st">    y3 ~ .i3 * 1</span></span>
<span><span class="st">    y4 ~ .i4 * 1</span></span>
<span><span class="st">    y1 ~~ .u1_1 * y1</span></span>
<span><span class="st">    y2 ~~ .u2_1 * y2</span></span>
<span><span class="st">    y3 ~~ .u3_1 * y3</span></span>
<span><span class="st">    y4 ~~ .u4_1 * y4</span></span>
<span><span class="st">    </span></span>
<span><span class="st">    # Time 2</span></span>
<span><span class="st">    dem65 =~ .l1 * y5 + .l2 * y6 + .l3 * y7 + .l4 * y8</span></span>
<span><span class="st">    y5 ~ .i1 * 1</span></span>
<span><span class="st">    y6 ~ .i2 * 1</span></span>
<span><span class="st">    y7 ~ .i3 * 1</span></span>
<span><span class="st">    y8 ~ .i4 * 1</span></span>
<span><span class="st">    y5 ~~ .u1_2 * y5</span></span>
<span><span class="st">    y6 ~~ .u2_2 * y6</span></span>
<span><span class="st">    y7 ~~ .u3_2 * y7</span></span>
<span><span class="st">    y8 ~~ .u4_2 * y8</span></span>
<span><span class="st">    </span></span>
<span><span class="st">    # Latent variances</span></span>
<span><span class="st">    dem60 ~~ 1 * dem60</span></span>
<span><span class="st">    dem65 ~~ NA * dem65</span></span>
<span><span class="st">    </span></span>
<span><span class="st">    # Latent means</span></span>
<span><span class="st">    dem60 ~ 0 * 1</span></span>
<span><span class="st">    dem65 ~ NA * 1</span></span>
<span><span class="st">    </span></span>
<span><span class="st">    # Lag Covariances</span></span>
<span><span class="st">    y1 ~~ y5</span></span>
<span><span class="st">    y2 ~~ y6</span></span>
<span><span class="st">    y3 ~~ y7</span></span>
<span><span class="st">    y4 ~~ y8</span></span>
<span><span class="st">"</span></span>
<span><span class="va">lscalar_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/cfa.html" class="external-link">cfa</a></span><span class="op">(</span></span>
<span>    <span class="va">lscalar_mod</span>,</span>
<span>    data <span class="op">=</span> <span class="va">PoliticalDemocracy</span>,</span>
<span>    std.lv <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    missing <span class="op">=</span> <span class="st">"fiml"</span>,</span>
<span>    estimator <span class="op">=</span> <span class="st">"mlr"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/parameterEstimates.html" class="external-link">parameterEstimates</a></span><span class="op">(</span><span class="va">lscalar_fit</span><span class="op">)</span></span>
<span><span class="co">#&gt;      lhs op   rhs label    est    se      z pvalue ci.lower ci.upper</span></span>
<span><span class="co">#&gt; 1  dem60 =~    y1   .l1  2.085 0.211  9.884  0.000    1.672    2.498</span></span>
<span><span class="co">#&gt; 2  dem60 =~    y2   .l2  2.896 0.284 10.189  0.000    2.339    3.453</span></span>
<span><span class="co">#&gt; 3  dem60 =~    y3   .l3  2.552 0.246 10.366  0.000    2.069    3.034</span></span>
<span><span class="co">#&gt; 4  dem60 =~    y4   .l4  2.889 0.225 12.842  0.000    2.448    3.330</span></span>
<span><span class="co">#&gt; 5     y1 ~1         .i1  5.508 0.289 19.037  0.000    4.941    6.075</span></span>
<span><span class="co">#&gt; 6     y2 ~1         .i2  3.796 0.429  8.856  0.000    2.956    4.636</span></span>
<span><span class="co">#&gt; 7     y3 ~1         .i3  6.670 0.353 18.915  0.000    5.979    7.361</span></span>
<span><span class="co">#&gt; 8     y4 ~1         .i4  4.554 0.366 12.458  0.000    3.838    5.270</span></span>
<span><span class="co">#&gt; 9     y1 ~~    y1 .u1_1  2.141 0.488  4.384  0.000    1.184    3.098</span></span>
<span><span class="co">#&gt; 10    y2 ~~    y2 .u2_1  6.840 1.444  4.738  0.000    4.010    9.669</span></span>
<span><span class="co">#&gt; 11    y3 ~~    y3 .u3_1  5.424 1.101  4.927  0.000    3.266    7.582</span></span>
<span><span class="co">#&gt; 12    y4 ~~    y4 .u4_1  2.623 0.641  4.091  0.000    1.366    3.879</span></span>
<span><span class="co">#&gt; 13 dem65 =~    y5   .l1  2.085 0.211  9.884  0.000    1.672    2.498</span></span>
<span><span class="co">#&gt; 14 dem65 =~    y6   .l2  2.896 0.284 10.189  0.000    2.339    3.453</span></span>
<span><span class="co">#&gt; 15 dem65 =~    y7   .l3  2.552 0.246 10.366  0.000    2.069    3.034</span></span>
<span><span class="co">#&gt; 16 dem65 =~    y8   .l4  2.889 0.225 12.842  0.000    2.448    3.330</span></span>
<span><span class="co">#&gt; 17    y5 ~1         .i1  5.508 0.289 19.037  0.000    4.941    6.075</span></span>
<span><span class="co">#&gt; 18    y6 ~1         .i2  3.796 0.429  8.856  0.000    2.956    4.636</span></span>
<span><span class="co">#&gt; 19    y7 ~1         .i3  6.670 0.353 18.915  0.000    5.979    7.361</span></span>
<span><span class="co">#&gt; 20    y8 ~1         .i4  4.554 0.366 12.458  0.000    3.838    5.270</span></span>
<span><span class="co">#&gt; 21    y5 ~~    y5 .u1_2  2.824 0.577  4.895  0.000    1.693    3.954</span></span>
<span><span class="co">#&gt; 22    y6 ~~    y6 .u2_2  4.032 0.818  4.931  0.000    2.429    5.634</span></span>
<span><span class="co">#&gt; 23    y7 ~~    y7 .u3_2  3.650 0.639  5.713  0.000    2.398    4.903</span></span>
<span><span class="co">#&gt; 24    y8 ~~    y8 .u4_2  2.482 0.705  3.522  0.000    1.101    3.863</span></span>
<span><span class="co">#&gt; 25 dem60 ~~ dem60        1.000 0.000     NA     NA    1.000    1.000</span></span>
<span><span class="co">#&gt; 26 dem65 ~~ dem65        0.947 0.097  9.745  0.000    0.756    1.137</span></span>
<span><span class="co">#&gt; 27 dem60 ~1              0.000 0.000     NA     NA    0.000    0.000</span></span>
<span><span class="co">#&gt; 28 dem65 ~1             -0.210 0.067 -3.115  0.002   -0.342   -0.078</span></span>
<span><span class="co">#&gt; 29    y1 ~~    y5        0.845 0.433  1.953  0.051   -0.003    1.694</span></span>
<span><span class="co">#&gt; 30    y2 ~~    y6        1.670 0.934  1.788  0.074   -0.161    3.502</span></span>
<span><span class="co">#&gt; 31    y3 ~~    y7        1.206 0.646  1.868  0.062   -0.060    2.472</span></span>
<span><span class="co">#&gt; 32    y4 ~~    y8        0.261 0.465  0.563  0.574   -0.649    1.172</span></span>
<span><span class="co">#&gt; 33 dem60 ~~ dem65        0.918 0.057 16.191  0.000    0.807    1.030</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Hok Chio (Mark) Lai.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
