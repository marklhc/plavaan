<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Penalized Estimation of Cross-Loadings and Unique Covariances • plavaan</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Penalized Estimation of Cross-Loadings and Unique Covariances">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">plavaan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/approximate-invariance.html">Approximate Invariance with Penalized Estimation</a></li>
    <li><a class="dropdown-item" href="../articles/penalized-cat.html">Penalized Estimation with Ordinal Data and Multiple Groups</a></li>
    <li><a class="dropdown-item" href="../articles/penalized-fa.html">Penalized Estimation of Cross-Loadings and Unique Covariances</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Penalized Estimation of Cross-Loadings and Unique Covariances</h1>
            
      

      <div class="d-none name"><code>penalized-fa.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://marklhc.github.io/plavaan/">plavaan</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lavaan.ugent.be" class="external-link">lavaan</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; This is lavaan 0.6-20</span></span>
<span><span class="co">#&gt; lavaan is FREE software! Please report any bugs.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">PoliticalDemocracy</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="penalize-cross-loadings">Penalize cross-loadings<a class="anchor" aria-label="anchor" href="#penalize-cross-loadings"></a>
</h2>
<div class="section level3">
<h3 id="two-factor-cfa-model">Two-factor CFA model<a class="anchor" aria-label="anchor" href="#two-factor-cfa-model"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod0</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">  ind60 =~ x1 + x2 + x3</span></span>
<span><span class="st">  dem60 =~ y1 + y2 + y3 + y4</span></span>
<span><span class="st">  ind60 ~~ dem60</span></span>
<span><span class="st">"</span></span>
<span><span class="va">fit0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/cfa.html" class="external-link">cfa</a></span><span class="op">(</span><span class="va">mod0</span>, data <span class="op">=</span> <span class="va">PoliticalDemocracy</span>, std.lv <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="two-factor-efa-model-unidentified">Two-factor EFA model (unidentified)<a class="anchor" aria-label="anchor" href="#two-factor-efa-model-unidentified"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">  ind60 =~ x1 + x2 + x3 + y1 + y2 + y3 + y4</span></span>
<span><span class="st">  dem60 =~ x1 + x2 + x3 + y1 + y2 + y3 + y4</span></span>
<span><span class="st">  ind60 ~~ ind60</span></span>
<span><span class="st">"</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/cfa.html" class="external-link">cfa</a></span><span class="op">(</span><span class="va">mod</span>, data <span class="op">=</span> <span class="va">PoliticalDemocracy</span>, std.lv <span class="op">=</span> <span class="cn">TRUE</span>, do.fit <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="two-factor-efa-model-with-penalized-cross-loadings">Two-factor EFA model with penalized cross-loadings<a class="anchor" aria-label="anchor" href="#two-factor-efa-model-with-penalized-cross-loadings"></a>
</h3>
<p>The cross-loadings are the parameters 4 to 10 in the parameter table
(see the <code>free</code> column).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/parTable.html" class="external-link">parTable</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">#&gt;    id   lhs op   rhs user block group free ustart exo label plabel start   est</span></span>
<span><span class="co">#&gt; 1   1 ind60 =~    x1    1     1     1    1     NA   0         .p1. 0.951 0.951</span></span>
<span><span class="co">#&gt; 2   2 ind60 =~    x2    1     1     1    2     NA   0         .p2. 2.001 2.001</span></span>
<span><span class="co">#&gt; 3   3 ind60 =~    x3    1     1     1    3     NA   0         .p3. 1.687 1.687</span></span>
<span><span class="co">#&gt; 4   4 ind60 =~    y1    1     1     1    4     NA   0         .p4. 1.344 1.344</span></span>
<span><span class="co">#&gt; 5   5 ind60 =~    y2    1     1     1    5     NA   0         .p5. 1.807 1.807</span></span>
<span><span class="co">#&gt; 6   6 ind60 =~    y3    1     1     1    6     NA   0         .p6. 1.778 1.778</span></span>
<span><span class="co">#&gt; 7   7 ind60 =~    y4    1     1     1    7     NA   0         .p7. 2.256 2.256</span></span>
<span><span class="co">#&gt; 8   8 dem60 =~    x1    1     1     1    8     NA   0         .p8. 0.951 0.951</span></span>
<span><span class="co">#&gt; 9   9 dem60 =~    x2    1     1     1    9     NA   0         .p9. 2.001 2.001</span></span>
<span><span class="co">#&gt; 10 10 dem60 =~    x3    1     1     1   10     NA   0        .p10. 1.687 1.687</span></span>
<span><span class="co">#&gt; 11 11 dem60 =~    y1    1     1     1   11     NA   0        .p11. 1.344 1.344</span></span>
<span><span class="co">#&gt; 12 12 dem60 =~    y2    1     1     1   12     NA   0        .p12. 1.807 1.807</span></span>
<span><span class="co">#&gt; 13 13 dem60 =~    y3    1     1     1   13     NA   0        .p13. 1.778 1.778</span></span>
<span><span class="co">#&gt; 14 14 dem60 =~    y4    1     1     1   14     NA   0        .p14. 2.256 2.256</span></span>
<span><span class="co">#&gt; 15 15 ind60 ~~ ind60    1     1     1    0      1   0        .p15. 1.000 1.000</span></span>
<span><span class="co">#&gt; 16 16    x1 ~~    x1    0     1     1   15     NA   0        .p16. 0.265 0.265</span></span>
<span><span class="co">#&gt; 17 17    x2 ~~    x2    0     1     1   16     NA   0        .p17. 1.126 1.126</span></span>
<span><span class="co">#&gt; 18 18    x3 ~~    x3    0     1     1   17     NA   0        .p18. 0.975 0.975</span></span>
<span><span class="co">#&gt; 19 19    y1 ~~    y1    0     1     1   18     NA   0        .p19. 3.393 3.393</span></span>
<span><span class="co">#&gt; 20 20    y2 ~~    y2    0     1     1   19     NA   0        .p20. 7.686 7.686</span></span>
<span><span class="co">#&gt; 21 21    y3 ~~    y3    0     1     1   20     NA   0        .p21. 5.310 5.310</span></span>
<span><span class="co">#&gt; 22 22    y4 ~~    y4    0     1     1   21     NA   0        .p22. 5.535 5.535</span></span>
<span><span class="co">#&gt; 23 23 dem60 ~~ dem60    0     1     1    0      1   0        .p23. 1.000 1.000</span></span>
<span><span class="co">#&gt; 24 24 ind60 ~~ dem60    0     1     1   22     NA   0        .p24. 0.000 0.000</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pefa_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/penalized_est.html">penalized_est</a></span><span class="op">(</span></span>
<span>    <span class="va">fit</span>,</span>
<span>    w <span class="op">=</span> <span class="fl">.03</span>,</span>
<span>    pen_par_id <span class="op">=</span> <span class="fl">4</span><span class="op">:</span><span class="fl">10</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">pefa_fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; lavaan 0.6-20 ended normally after 126 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Estimator                                         ML</span></span>
<span><span class="co">#&gt;   Optimization method                           NLMINB</span></span>
<span><span class="co">#&gt;   Number of model parameters                        22</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Number of observations                            75</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter Estimates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Latent Variables:</span></span>
<span><span class="co">#&gt;                    Estimate</span></span>
<span><span class="co">#&gt;   ind60 =~                 </span></span>
<span><span class="co">#&gt;     x1                0.658</span></span>
<span><span class="co">#&gt;     x2                1.456</span></span>
<span><span class="co">#&gt;     x3                1.222</span></span>
<span><span class="co">#&gt;     y1               -0.007</span></span>
<span><span class="co">#&gt;     y2               -0.608</span></span>
<span><span class="co">#&gt;     y3               -0.001</span></span>
<span><span class="co">#&gt;     y4                0.006</span></span>
<span><span class="co">#&gt;   dem60 =~                 </span></span>
<span><span class="co">#&gt;     x1                0.025</span></span>
<span><span class="co">#&gt;     x2               -0.002</span></span>
<span><span class="co">#&gt;     x3               -0.010</span></span>
<span><span class="co">#&gt;     y1                2.071</span></span>
<span><span class="co">#&gt;     y2                3.290</span></span>
<span><span class="co">#&gt;     y3                2.256</span></span>
<span><span class="co">#&gt;     y4                2.999</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariances:</span></span>
<span><span class="co">#&gt;                    Estimate</span></span>
<span><span class="co">#&gt;   ind60 ~~                 </span></span>
<span><span class="co">#&gt;     dem60             0.481</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances:</span></span>
<span><span class="co">#&gt;                    Estimate</span></span>
<span><span class="co">#&gt;     ind60             1.000</span></span>
<span><span class="co">#&gt;    .x1                0.079</span></span>
<span><span class="co">#&gt;    .x2                0.127</span></span>
<span><span class="co">#&gt;    .x3                0.464</span></span>
<span><span class="co">#&gt;    .y1                2.493</span></span>
<span><span class="co">#&gt;    .y2                6.048</span></span>
<span><span class="co">#&gt;    .y3                5.512</span></span>
<span><span class="co">#&gt;    .y4                2.017</span></span>
<span><span class="co">#&gt;     dem60             1.000</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="penalize-cross-loadings-and-unique-covariances">Penalize Cross-loadings and Unique Covariances<a class="anchor" aria-label="anchor" href="#penalize-cross-loadings-and-unique-covariances"></a>
</h2>
<div class="section level3">
<h3 id="two-factor-efa-model-with-unique-covariances">Two-factor EFA model with unique covariances<a class="anchor" aria-label="anchor" href="#two-factor-efa-model-with-unique-covariances"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">  ind60 =~ x1 + x2 + x3 + y1 + y2 + y3 + y4</span></span>
<span><span class="st">  dem60 =~ x1 + x2 + x3 + y1 + y2 + y3 + y4</span></span>
<span><span class="st">  ind60 ~~ ind60</span></span>
<span><span class="st">  x1 ~~ x2 + x3 + y1 + y2 + y3 + y4</span></span>
<span><span class="st">  x2 ~~ x3 + y1 + y2 + y3 + y4</span></span>
<span><span class="st">  x3 ~~ y1 + y2 + y3 + y4</span></span>
<span><span class="st">  y1 ~~ y2 + y3 + y4</span></span>
<span><span class="st">  y2 ~~ y3 + y4</span></span>
<span><span class="st">  y3 ~~ y4</span></span>
<span><span class="st">"</span></span>
<span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/cfa.html" class="external-link">cfa</a></span><span class="op">(</span><span class="va">mod2</span>, data <span class="op">=</span> <span class="va">PoliticalDemocracy</span>, std.lv <span class="op">=</span> <span class="cn">TRUE</span>, do.fit <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="two-factor-efa-model-with-penalized-cross-loadings-and-unique-covariances">Two-factor EFA model with penalized cross-loadings and unique
covariances<a class="anchor" aria-label="anchor" href="#two-factor-efa-model-with-penalized-cross-loadings-and-unique-covariances"></a>
</h3>
<p>The unique covariances are the parameters 15 to 35 in the parameter
table (see the <code>free</code> column).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/parTable.html" class="external-link">parTable</a></span><span class="op">(</span><span class="va">fit2</span><span class="op">)</span></span>
<span><span class="co">#&gt;    id   lhs op   rhs user block group free ustart exo label plabel start   est</span></span>
<span><span class="co">#&gt; 1   1 ind60 =~    x1    1     1     1    1     NA   0         .p1. 0.951 0.951</span></span>
<span><span class="co">#&gt; 2   2 ind60 =~    x2    1     1     1    2     NA   0         .p2. 2.001 2.001</span></span>
<span><span class="co">#&gt; 3   3 ind60 =~    x3    1     1     1    3     NA   0         .p3. 1.687 1.687</span></span>
<span><span class="co">#&gt; 4   4 ind60 =~    y1    1     1     1    4     NA   0         .p4. 1.344 1.344</span></span>
<span><span class="co">#&gt; 5   5 ind60 =~    y2    1     1     1    5     NA   0         .p5. 1.807 1.807</span></span>
<span><span class="co">#&gt; 6   6 ind60 =~    y3    1     1     1    6     NA   0         .p6. 1.778 1.778</span></span>
<span><span class="co">#&gt; 7   7 ind60 =~    y4    1     1     1    7     NA   0         .p7. 2.256 2.256</span></span>
<span><span class="co">#&gt; 8   8 dem60 =~    x1    1     1     1    8     NA   0         .p8. 0.951 0.951</span></span>
<span><span class="co">#&gt; 9   9 dem60 =~    x2    1     1     1    9     NA   0         .p9. 2.001 2.001</span></span>
<span><span class="co">#&gt; 10 10 dem60 =~    x3    1     1     1   10     NA   0        .p10. 1.687 1.687</span></span>
<span><span class="co">#&gt; 11 11 dem60 =~    y1    1     1     1   11     NA   0        .p11. 1.344 1.344</span></span>
<span><span class="co">#&gt; 12 12 dem60 =~    y2    1     1     1   12     NA   0        .p12. 1.807 1.807</span></span>
<span><span class="co">#&gt; 13 13 dem60 =~    y3    1     1     1   13     NA   0        .p13. 1.778 1.778</span></span>
<span><span class="co">#&gt; 14 14 dem60 =~    y4    1     1     1   14     NA   0        .p14. 2.256 2.256</span></span>
<span><span class="co">#&gt; 15 15 ind60 ~~ ind60    1     1     1    0      1   0        .p15. 1.000 1.000</span></span>
<span><span class="co">#&gt; 16 16    x1 ~~    x2    1     1     1   15     NA   0        .p16. 0.000 0.000</span></span>
<span><span class="co">#&gt; 17 17    x1 ~~    x3    1     1     1   16     NA   0        .p17. 0.000 0.000</span></span>
<span><span class="co">#&gt; 18 18    x1 ~~    y1    1     1     1   17     NA   0        .p18. 0.000 0.000</span></span>
<span><span class="co">#&gt; 19 19    x1 ~~    y2    1     1     1   18     NA   0        .p19. 0.000 0.000</span></span>
<span><span class="co">#&gt; 20 20    x1 ~~    y3    1     1     1   19     NA   0        .p20. 0.000 0.000</span></span>
<span><span class="co">#&gt; 21 21    x1 ~~    y4    1     1     1   20     NA   0        .p21. 0.000 0.000</span></span>
<span><span class="co">#&gt; 22 22    x2 ~~    x3    1     1     1   21     NA   0        .p22. 0.000 0.000</span></span>
<span><span class="co">#&gt; 23 23    x2 ~~    y1    1     1     1   22     NA   0        .p23. 0.000 0.000</span></span>
<span><span class="co">#&gt; 24 24    x2 ~~    y2    1     1     1   23     NA   0        .p24. 0.000 0.000</span></span>
<span><span class="co">#&gt; 25 25    x2 ~~    y3    1     1     1   24     NA   0        .p25. 0.000 0.000</span></span>
<span><span class="co">#&gt; 26 26    x2 ~~    y4    1     1     1   25     NA   0        .p26. 0.000 0.000</span></span>
<span><span class="co">#&gt; 27 27    x3 ~~    y1    1     1     1   26     NA   0        .p27. 0.000 0.000</span></span>
<span><span class="co">#&gt; 28 28    x3 ~~    y2    1     1     1   27     NA   0        .p28. 0.000 0.000</span></span>
<span><span class="co">#&gt; 29 29    x3 ~~    y3    1     1     1   28     NA   0        .p29. 0.000 0.000</span></span>
<span><span class="co">#&gt; 30 30    x3 ~~    y4    1     1     1   29     NA   0        .p30. 0.000 0.000</span></span>
<span><span class="co">#&gt; 31 31    y1 ~~    y2    1     1     1   30     NA   0        .p31. 0.000 0.000</span></span>
<span><span class="co">#&gt; 32 32    y1 ~~    y3    1     1     1   31     NA   0        .p32. 0.000 0.000</span></span>
<span><span class="co">#&gt; 33 33    y1 ~~    y4    1     1     1   32     NA   0        .p33. 0.000 0.000</span></span>
<span><span class="co">#&gt; 34 34    y2 ~~    y3    1     1     1   33     NA   0        .p34. 0.000 0.000</span></span>
<span><span class="co">#&gt; 35 35    y2 ~~    y4    1     1     1   34     NA   0        .p35. 0.000 0.000</span></span>
<span><span class="co">#&gt; 36 36    y3 ~~    y4    1     1     1   35     NA   0        .p36. 0.000 0.000</span></span>
<span><span class="co">#&gt; 37 37    x1 ~~    x1    0     1     1   36     NA   0        .p37. 0.265 0.265</span></span>
<span><span class="co">#&gt; 38 38    x2 ~~    x2    0     1     1   37     NA   0        .p38. 1.126 1.126</span></span>
<span><span class="co">#&gt; 39 39    x3 ~~    x3    0     1     1   38     NA   0        .p39. 0.975 0.975</span></span>
<span><span class="co">#&gt; 40 40    y1 ~~    y1    0     1     1   39     NA   0        .p40. 3.393 3.393</span></span>
<span><span class="co">#&gt; 41 41    y2 ~~    y2    0     1     1   40     NA   0        .p41. 7.686 7.686</span></span>
<span><span class="co">#&gt; 42 42    y3 ~~    y3    0     1     1   41     NA   0        .p42. 5.310 5.310</span></span>
<span><span class="co">#&gt; 43 43    y4 ~~    y4    0     1     1   42     NA   0        .p43. 5.535 5.535</span></span>
<span><span class="co">#&gt; 44 44 dem60 ~~ dem60    0     1     1    0      1   0        .p44. 1.000 1.000</span></span>
<span><span class="co">#&gt; 45 45 ind60 ~~ dem60    0     1     1   43     NA   0        .p45. 0.000 0.000</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pefa_fit2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/penalized_est.html">penalized_est</a></span><span class="op">(</span></span>
<span>    <span class="va">fit2</span>,</span>
<span>    w <span class="op">=</span> <span class="fl">.03</span>,</span>
<span>    pen_par_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">15</span><span class="op">:</span><span class="fl">35</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">pefa_fit2</span><span class="op">)</span></span>
<span><span class="co">#&gt; lavaan 0.6-20 ended normally after 195 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Estimator                                         ML</span></span>
<span><span class="co">#&gt;   Optimization method                           NLMINB</span></span>
<span><span class="co">#&gt;   Number of model parameters                        43</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Number of observations                            75</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter Estimates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Latent Variables:</span></span>
<span><span class="co">#&gt;                    Estimate</span></span>
<span><span class="co">#&gt;   ind60 =~                 </span></span>
<span><span class="co">#&gt;     x1                0.665</span></span>
<span><span class="co">#&gt;     x2                1.449</span></span>
<span><span class="co">#&gt;     x3                1.225</span></span>
<span><span class="co">#&gt;     y1                0.003</span></span>
<span><span class="co">#&gt;     y2               -0.005</span></span>
<span><span class="co">#&gt;     y3                0.003</span></span>
<span><span class="co">#&gt;     y4                0.455</span></span>
<span><span class="co">#&gt;   dem60 =~                 </span></span>
<span><span class="co">#&gt;     x1                0.020</span></span>
<span><span class="co">#&gt;     x2                0.001</span></span>
<span><span class="co">#&gt;     x3               -0.012</span></span>
<span><span class="co">#&gt;     y1                2.119</span></span>
<span><span class="co">#&gt;     y2                3.018</span></span>
<span><span class="co">#&gt;     y3                2.307</span></span>
<span><span class="co">#&gt;     y4                2.743</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariances:</span></span>
<span><span class="co">#&gt;                    Estimate</span></span>
<span><span class="co">#&gt;  .x1 ~~                    </span></span>
<span><span class="co">#&gt;    .x2               -0.004</span></span>
<span><span class="co">#&gt;    .x3               -0.009</span></span>
<span><span class="co">#&gt;    .y1                0.054</span></span>
<span><span class="co">#&gt;    .y2               -0.050</span></span>
<span><span class="co">#&gt;    .y3                0.001</span></span>
<span><span class="co">#&gt;    .y4                0.018</span></span>
<span><span class="co">#&gt;  .x2 ~~                    </span></span>
<span><span class="co">#&gt;    .x3                0.006</span></span>
<span><span class="co">#&gt;    .y1               -0.002</span></span>
<span><span class="co">#&gt;    .y2                0.005</span></span>
<span><span class="co">#&gt;    .y3                0.010</span></span>
<span><span class="co">#&gt;    .y4               -0.012</span></span>
<span><span class="co">#&gt;  .x3 ~~                    </span></span>
<span><span class="co">#&gt;    .y1               -0.010</span></span>
<span><span class="co">#&gt;    .y2                0.003</span></span>
<span><span class="co">#&gt;    .y3               -0.008</span></span>
<span><span class="co">#&gt;    .y4                0.006</span></span>
<span><span class="co">#&gt;  .y1 ~~                    </span></span>
<span><span class="co">#&gt;    .y2               -0.002</span></span>
<span><span class="co">#&gt;    .y3                0.012</span></span>
<span><span class="co">#&gt;    .y4               -0.009</span></span>
<span><span class="co">#&gt;  .y2 ~~                    </span></span>
<span><span class="co">#&gt;    .y3               -0.006</span></span>
<span><span class="co">#&gt;    .y4                0.008</span></span>
<span><span class="co">#&gt;  .y3 ~~                    </span></span>
<span><span class="co">#&gt;    .y4               -0.003</span></span>
<span><span class="co">#&gt;   ind60 ~~                 </span></span>
<span><span class="co">#&gt;     dem60             0.391</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances:</span></span>
<span><span class="co">#&gt;                    Estimate</span></span>
<span><span class="co">#&gt;     ind60             1.000</span></span>
<span><span class="co">#&gt;    .x1                0.069</span></span>
<span><span class="co">#&gt;    .x2                0.143</span></span>
<span><span class="co">#&gt;    .x3                0.454</span></span>
<span><span class="co">#&gt;    .y1                2.193</span></span>
<span><span class="co">#&gt;    .y2                6.148</span></span>
<span><span class="co">#&gt;    .y3                5.246</span></span>
<span><span class="co">#&gt;    .y4                2.295</span></span>
<span><span class="co">#&gt;     dem60             1.000</span></span></code></pre></div>
<p>The unique covariances were all estimated close to zero. One can
approximate the “effective” number of cross-loadings and unique
covariances by:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pen_ests</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">pefa_fit2</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">15</span><span class="op">:</span><span class="fl">35</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="../reference/loss.html">l0a</a></span><span class="op">(</span><span class="va">pen_ests</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1.564463</span></span></code></pre></div>
<p>So out of 28 parameters penalized, only about 1.6 (or close to 2) are
effectively non-zero.</p>
</div>
</div>
<div class="section level2">
<h2 id="penalize-cross-loadings-unique-covariances-and-difference-in-loadings-and-intercepts-across-time">Penalize Cross-Loadings, Unique Covariances, and Difference in
Loadings and Intercepts Across Time<a class="anchor" aria-label="anchor" href="#penalize-cross-loadings-unique-covariances-and-difference-in-loadings-and-intercepts-across-time"></a>
</h2>
<p>First, the model without cross-loadings and concurrent unique
covariances</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod3</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">    ind60 =~ NA * x1 + x2 + x3</span></span>
<span><span class="st">    dem60 =~ NA * l1 * y1 + l2 * y2 + l3 * y3 + l4 * y4</span></span>
<span><span class="st">    dem65 =~ NA * l1 * y5 + l2 * y6 + l3 * y7 + l4 * y8</span></span>
<span><span class="st">    dem60 ~ ind60</span></span>
<span><span class="st">    dem65 ~ ind60 + dem60</span></span>
<span><span class="st">    ind60 ~~ 1 * ind60</span></span>
<span><span class="st">    dem60 ~~ 1 * dem60</span></span>
<span><span class="st">    dem65 ~~ NA * dem65</span></span>
<span><span class="st">    ind60 ~ 0 * 1</span></span>
<span><span class="st">    dem60 ~ 0 * 1</span></span>
<span><span class="st">    dem65 ~ NA * 1</span></span>
<span><span class="st">    x1 + x2 + x3 ~ NA * 1</span></span>
<span><span class="st">    y1 ~ i1 * 1</span></span>
<span><span class="st">    y2 ~ i2 * 1</span></span>
<span><span class="st">    y3 ~ i3 * 1</span></span>
<span><span class="st">    y4 ~ i4 * 1</span></span>
<span><span class="st">    y5 ~ i1 * 1</span></span>
<span><span class="st">    y6 ~ i2 * 1</span></span>
<span><span class="st">    y7 ~ i3 * 1</span></span>
<span><span class="st">    y8 ~ i4 * 1</span></span>
<span><span class="st">    y1 ~~ y5</span></span>
<span><span class="st">    y2 ~~ y6</span></span>
<span><span class="st">    y3 ~~ y7</span></span>
<span><span class="st">    y4 ~~ y8</span></span>
<span><span class="st">"</span></span>
<span><span class="va">fit3_base</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/cfa.html" class="external-link">cfa</a></span><span class="op">(</span><span class="va">mod3</span>, data <span class="op">=</span> <span class="va">PoliticalDemocracy</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Lavaan example of Political Democracy</span></span>
<span><span class="va">mod3_un</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">    ind60 =~ NA * x1 + x2 + x3 + y1 + y2 + y3 + y4</span></span>
<span><span class="st">    dem60 =~ NA * x1 + x2 + x3 + y1 + y2 + y3 + y4</span></span>
<span><span class="st">    dem65 =~ NA * y5 + y6 + y7 + y8</span></span>
<span><span class="st">    dem60 ~ ind60</span></span>
<span><span class="st">    dem65 ~ ind60 + dem60</span></span>
<span><span class="st">    ind60 ~~ 1 * ind60</span></span>
<span><span class="st">    dem60 ~~ 1 * dem60</span></span>
<span><span class="st">    dem65 ~~ NA * dem65</span></span>
<span><span class="st">    ind60 ~ 0 * 1</span></span>
<span><span class="st">    dem60 ~ 0 * 1</span></span>
<span><span class="st">    dem65 ~ NA * 1</span></span>
<span><span class="st">    x1 + x2 + x3 + y1 + y2 + y3 + y4 ~ NA * 1</span></span>
<span><span class="st">    y5 + y6 + y7 + y8 ~ NA * 1</span></span>
<span><span class="st">    x1 ~~ x2 + x3 + y1 + y2 + y3 + y4</span></span>
<span><span class="st">    x2 ~~ x3 + y1 + y2 + y3 + y4</span></span>
<span><span class="st">    x3 ~~ y1 + y2 + y3 + y4</span></span>
<span><span class="st">    y1 ~~ y2 + y3 + y4</span></span>
<span><span class="st">    y2 ~~ y3 + y4</span></span>
<span><span class="st">    y3 ~~ y4</span></span>
<span><span class="st">    y1 ~~ y5</span></span>
<span><span class="st">    y2 ~~ y6</span></span>
<span><span class="st">    y3 ~~ y7</span></span>
<span><span class="st">    y4 ~~ y8</span></span>
<span><span class="st">"</span></span>
<span><span class="va">fit3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/cfa.html" class="external-link">cfa</a></span><span class="op">(</span></span>
<span>    <span class="va">mod3_un</span>,</span>
<span>    data <span class="op">=</span> <span class="va">PoliticalDemocracy</span>,</span>
<span>    do.fit <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    start <span class="op">=</span> <span class="va">fit3_base</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pt3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/parTable.html" class="external-link">parTable</a></span><span class="op">(</span><span class="va">fit3</span><span class="op">)</span></span>
<span><span class="co"># Provide better starting values</span></span>
<span><span class="va">pt3</span><span class="op">$</span><span class="va">start</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">35</span><span class="op">:</span><span class="fl">55</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">fit3_2</span> <span class="op">&lt;-</span> <span class="fu">lavaan</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/cfa.html" class="external-link">cfa</a></span><span class="op">(</span></span>
<span>    <span class="va">pt3</span>,</span>
<span>    data <span class="op">=</span> <span class="va">PoliticalDemocracy</span>,</span>
<span>    do.fit <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Parameter IDs:</p>
<ul>
<li>(Concurrent) Cross-loadings: 4 to 10</li>
<li>(Concurrent) Unique covariances: 35 to 55</li>
<li>Loadings across time: 11 to 18</li>
<li>Intercepts across time: 27 to 34</li>
</ul>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pefa_fit3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/penalized_est.html">penalized_est</a></span><span class="op">(</span></span>
<span>    <span class="va">fit3_2</span>,</span>
<span>    w <span class="op">=</span> <span class="fl">.03</span>,</span>
<span>    pen_par_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">35</span><span class="op">:</span><span class="fl">55</span><span class="op">)</span>,</span>
<span>    pen_diff_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        loadings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fl">11</span><span class="op">:</span><span class="fl">14</span>, <span class="fl">15</span><span class="op">:</span><span class="fl">18</span><span class="op">)</span>,</span>
<span>        intercepts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fl">27</span><span class="op">:</span><span class="fl">30</span>, <span class="fl">31</span><span class="op">:</span><span class="fl">34</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in trans(x): NaNs produced</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">pefa_fit3</span>, standardized <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; lavaan 0.6-20 ended normally after 219 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Estimator                                         ML</span></span>
<span><span class="co">#&gt;   Optimization method                           NLMINB</span></span>
<span><span class="co">#&gt;   Number of model parameters                        70</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Number of observations                            75</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter Estimates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Latent Variables:</span></span>
<span><span class="co">#&gt;                    Estimate   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;   ind60 =~                                   </span></span>
<span><span class="co">#&gt;     x1                0.753    0.753    1.038</span></span>
<span><span class="co">#&gt;     x2                1.660    1.660    1.108</span></span>
<span><span class="co">#&gt;     x3                1.421    1.421    1.020</span></span>
<span><span class="co">#&gt;     y1               -0.001   -0.001   -0.000</span></span>
<span><span class="co">#&gt;     y2               -0.001   -0.001   -0.000</span></span>
<span><span class="co">#&gt;     y3                0.479    0.479    0.141</span></span>
<span><span class="co">#&gt;     y4                0.623    0.623    0.191</span></span>
<span><span class="co">#&gt;   dem60 =~                                   </span></span>
<span><span class="co">#&gt;     x1                0.574    0.702    0.967</span></span>
<span><span class="co">#&gt;     x2                1.205    1.473    0.983</span></span>
<span><span class="co">#&gt;     x3                0.983    1.202    0.863</span></span>
<span><span class="co">#&gt;     y1                1.772    2.167    0.836</span></span>
<span><span class="co">#&gt;     y2                2.446    2.992    0.763</span></span>
<span><span class="co">#&gt;     y3                2.205    2.697    0.796</span></span>
<span><span class="co">#&gt;     y4                2.572    3.145    0.965</span></span>
<span><span class="co">#&gt;   dem65 =~                                   </span></span>
<span><span class="co">#&gt;     y5                1.768    1.992    0.772</span></span>
<span><span class="co">#&gt;     y6                2.439    2.747    0.801</span></span>
<span><span class="co">#&gt;     y7                2.250    2.535    0.798</span></span>
<span><span class="co">#&gt;     y8                2.535    2.856    0.875</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regressions:</span></span>
<span><span class="co">#&gt;                    Estimate   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;   dem60 ~                                    </span></span>
<span><span class="co">#&gt;     ind60            -0.704   -0.576   -0.576</span></span>
<span><span class="co">#&gt;   dem65 ~                                    </span></span>
<span><span class="co">#&gt;     ind60             0.316    0.281    0.281</span></span>
<span><span class="co">#&gt;     dem60             1.005    1.091    1.091</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariances:</span></span>
<span><span class="co">#&gt;                    Estimate   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;  .x1 ~~                                      </span></span>
<span><span class="co">#&gt;    .x2                0.001    0.001    0.008</span></span>
<span><span class="co">#&gt;    .x3               -0.007   -0.007   -0.037</span></span>
<span><span class="co">#&gt;    .y1                0.024    0.024    0.062</span></span>
<span><span class="co">#&gt;    .y2               -0.040   -0.040   -0.057</span></span>
<span><span class="co">#&gt;    .y3                0.006    0.006    0.010</span></span>
<span><span class="co">#&gt;    .y4                0.015    0.015    0.034</span></span>
<span><span class="co">#&gt;  .x2 ~~                                      </span></span>
<span><span class="co">#&gt;    .x3                0.001    0.001    0.004</span></span>
<span><span class="co">#&gt;    .y1               -0.009   -0.009   -0.016</span></span>
<span><span class="co">#&gt;    .y2                0.009    0.009    0.009</span></span>
<span><span class="co">#&gt;    .y3                0.006    0.006    0.007</span></span>
<span><span class="co">#&gt;    .y4               -0.010   -0.010   -0.017</span></span>
<span><span class="co">#&gt;  .x3 ~~                                      </span></span>
<span><span class="co">#&gt;    .y1               -0.006   -0.006   -0.007</span></span>
<span><span class="co">#&gt;    .y2                0.002    0.002    0.001</span></span>
<span><span class="co">#&gt;    .y3               -0.010   -0.010   -0.007</span></span>
<span><span class="co">#&gt;    .y4                0.009    0.009    0.008</span></span>
<span><span class="co">#&gt;  .y1 ~~                                      </span></span>
<span><span class="co">#&gt;    .y2               -0.008   -0.008   -0.002</span></span>
<span><span class="co">#&gt;    .y3                0.011    0.011    0.003</span></span>
<span><span class="co">#&gt;    .y4               -0.009   -0.009   -0.004</span></span>
<span><span class="co">#&gt;  .y2 ~~                                      </span></span>
<span><span class="co">#&gt;    .y3               -0.004   -0.004   -0.001</span></span>
<span><span class="co">#&gt;    .y4                0.010    0.010    0.002</span></span>
<span><span class="co">#&gt;  .y3 ~~                                      </span></span>
<span><span class="co">#&gt;    .y4                0.000    0.000    0.000</span></span>
<span><span class="co">#&gt;  .y1 ~~                                      </span></span>
<span><span class="co">#&gt;    .y5                0.902    0.902    0.387</span></span>
<span><span class="co">#&gt;  .y2 ~~                                      </span></span>
<span><span class="co">#&gt;    .y6                1.594    1.594    0.307</span></span>
<span><span class="co">#&gt;  .y3 ~~                                      </span></span>
<span><span class="co">#&gt;    .y7                1.257    1.257    0.281</span></span>
<span><span class="co">#&gt;  .y4 ~~                                      </span></span>
<span><span class="co">#&gt;    .y8                0.175    0.175    0.069</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Intercepts:</span></span>
<span><span class="co">#&gt;                    Estimate   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;     ind60             0.000    0.000    0.000</span></span>
<span><span class="co">#&gt;    .dem60             0.000    0.000    0.000</span></span>
<span><span class="co">#&gt;    .dem65            -0.235   -0.208   -0.208</span></span>
<span><span class="co">#&gt;    .x1                5.072    5.072    6.990</span></span>
<span><span class="co">#&gt;    .x2                4.820    4.820    3.216</span></span>
<span><span class="co">#&gt;    .x3                3.584    3.584    2.572</span></span>
<span><span class="co">#&gt;    .y1                5.458    5.458    2.106</span></span>
<span><span class="co">#&gt;    .y2                3.764    3.764    0.960</span></span>
<span><span class="co">#&gt;    .y3                6.628    6.628    1.956</span></span>
<span><span class="co">#&gt;    .y4                4.503    4.503    1.381</span></span>
<span><span class="co">#&gt;    .y5                5.464    5.464    2.118</span></span>
<span><span class="co">#&gt;    .y6                3.748    3.748    1.093</span></span>
<span><span class="co">#&gt;    .y7                6.633    6.633    2.089</span></span>
<span><span class="co">#&gt;    .y8                4.510    4.510    1.381</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances:</span></span>
<span><span class="co">#&gt;                    Estimate   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;     ind60             1.000    1.000    1.000</span></span>
<span><span class="co">#&gt;    .dem60             1.000    0.668    0.668</span></span>
<span><span class="co">#&gt;    .dem65             0.106    0.084    0.084</span></span>
<span><span class="co">#&gt;    .x1                0.076    0.076    0.144</span></span>
<span><span class="co">#&gt;    .x2                0.137    0.137    0.061</span></span>
<span><span class="co">#&gt;    .x3                0.445    0.445    0.229</span></span>
<span><span class="co">#&gt;    .y1                2.017    2.017    0.300</span></span>
<span><span class="co">#&gt;    .y2                6.413    6.413    0.417</span></span>
<span><span class="co">#&gt;    .y3                5.473    5.473    0.476</span></span>
<span><span class="co">#&gt;    .y4                2.601    2.601    0.245</span></span>
<span><span class="co">#&gt;    .y5                2.690    2.690    0.404</span></span>
<span><span class="co">#&gt;    .y6                4.211    4.211    0.358</span></span>
<span><span class="co">#&gt;    .y7                3.653    3.653    0.362</span></span>
<span><span class="co">#&gt;    .y8                2.503    2.503    0.235</span></span></code></pre></div>
<p>We can again compute the “effective” number of cross-loadings and
unique covariances that are non-zero:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pen_ests2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">pefa_fit3</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">35</span><span class="op">:</span><span class="fl">55</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="../reference/loss.html">l0a</a></span><span class="op">(</span><span class="va">pen_ests2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 5.1989</span></span></code></pre></div>
<p>And the “effective” number of loadings and intercepts that differ
across time:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ld_ests</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">pefa_fit3</span><span class="op">)</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">18</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">int_ests</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">pefa_fit3</span><span class="op">)</span><span class="op">[</span><span class="fl">27</span><span class="op">:</span><span class="fl">34</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">ld_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">ld_ests</span>, nrow <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">int_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">int_ests</span>, nrow <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/composite_pair_loss.html">composite_pair_loss</a></span><span class="op">(</span><span class="va">ld_mat</span>, fun <span class="op">=</span> <span class="va">l0a</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="../reference/composite_pair_loss.html">composite_pair_loss</a></span><span class="op">(</span><span class="va">int_mat</span>, fun <span class="op">=</span> <span class="va">l0a</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.3263673</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Hok Chio (Mark) Lai.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
